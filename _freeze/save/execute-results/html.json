{
  "hash": "bcc869f19392685748ea7782b6a00a22",
  "result": {
    "engine": "knitr",
    "markdown": "::: {.cell}\n\n:::\n\n\n\n# Save maps {#sec-save}\n\n<!-- add description on scale -->\n\nMaps created programmatically can serve several purposes, from exploratory, through visualizations of the processing steps, to being the final outputs of a given project.\nTherefore, often we want just to see our map on the screen, but sometimes we also want to save our map results to an external file.\n**tmap** objects can be directly saved to output files with `tmap_save()`^[Standard R approach of saving graphic files by opening a graphic device, e.g., `png()`, plotting the data, and then closing the device with `dev.off()` also works.].\n\nThe `tmap_save()` function allows to save our map in three groups of file formats, (a) raster graphics (@sec-raster-graphic-formats), (b) vector graphics (@sec-vector-graphic-formats), and (c) interactive ones (@sec-interactive-format).\nAdditionally, @sec-animations shows how to save map animations with the use of the `tmap_animation()` function.\n\nFor the examples in this section, we will use a simple map of the Slovenia polygon with the country name superimposed (not shown), stored in the `tm` object.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tmap)\nlibrary(sf)\nslo_borders = read_sf(\"data/slovenia/slo_border.gpkg\")\ntm = tm_shape(slo_borders) +\n    tm_polygons() +\n    tm_text(\"Name\", fontface = \"italic\")\ntm\n```\n:::\n\n\n\n## Raster graphic formats {#sec-raster-graphic-formats}\n\nRaster graphics are non-spatial relatives of spatial rasters.\nThe digital images are composed of many pixels -- squares filled with specific colors.\nMain raster graphic file formats include PNG, JPEG, BMP, and TIFF.\n<!-- jn: should we describe each in one sentence? -->\nOne of the major parameters of the raster graphic images is DPI (*Dots Per Inch*, in this context, a more proper name probably should be PPI, *Pixels Per Inch*) -- is a number of pixels per inch of the output image.\nFor example, if the width and height of our image are 10 inches, then DPI of 300 would mean that our final image would have 3000 by 3000 pixels, and DPI of 72 would result in an image of 720 by 720 pixels.\nTherefore, an image with the same width and height but a larger value of DPI would occupy more space on the hard drive but also have better quality.\n\nSaving **tmap** objects to a file can be done with the `tmap_save()`.\nIt usually accepts two arguments^[In fact, one argument is enough -- if you just provide a **tmap** object, then it will be saved to a `tmap01` file with some default format.] -- the first one, `tm`, is our map object, and the second one, `filename`, is the path to the created file.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmap_save(tm, \"my_map.png\")\n#> Map saved to my_map.png\n#> Resolution: 2503 by 1762 pixels\n#> Size: 8.34 by 5.87 inches (300 dpi)\n```\n:::\n\n\n\nBy default, DPI is set to 300, and the image width and height is automatically adjusted based on the map aspect ratio.\nThese parameters can be, however, changed with the `dpi`, `width`, and `height` arguments^[You can even specify just one of `width` or `height`, and the value of the second one will be calculated using the formula `asp = width / height`.].\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmap_save(tm, \"my_map.png\", width = 1000, height = 750, dpi = 300)\n#> Map saved to /home/jn/Science/geocompx/tmap/my_map.png\n#> Resolution: 1000 by 750 pixels\n#> Size: 3.33 by 2.5 inches (300 dpi)\n```\n:::\n\n\n\nThe units of `width` or `height` depend on the value you set: they are pixels (`\"px\"`) when the value is greater than 50, and inches (`\"in\"`) otherwise.\nUnits can also be changed with the `units` argument.\n\nThis function also has several additional arguments, including `outer.margins`, `scale` and `asp`.\nAll of them override the arguments' values set in `tm_layout()` (@sec-layout).\nAdditionally, when set to `0`, the `asp` argument has a side effect: it moves the map frame to the edges of the output image.\n\nBy default, **tmap** uses graphic devices^[Short discussion about graphic devices can be found in section @sec-fonts-tmap.] incorporated in R.\nHowever, it is also possible to use other, external devices with the `device` argument.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmap_save(tm, \"my_map.png\", device = ragg::agg_png)\n```\n:::\n\n\n\nFor example, the `ragg::agg_png` device is usually faster and has better support for non-standard fonts than the regular `grDevices::png`.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\n## Vector graphic formats {#sec-vector-graphic-formats}\n\nVector graphics are quite distant relatives of spatial vectors, with vector graphics consisting of sets of coordinates.\nContrary to spatial vectors, however, their coordinates can be connected not only by straight lines (@sec-vector-data-model), but also using curves.\nThis makes it possible to create polygons, circles, ellipses, and others.\nThey also allow text and other objects to be stored.\nCommon vector graphic file formats are SVG, EPS, and PDF.\n\nTo save a map to a vector graphic format, we still can use `tmap_save()` but either with a suitable file extension or by using the `device` argument, for example `device = svglite::svglite`.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmap_save(tm, \"my_map.svg\")\n#> Map saved to /home/jn/Science/geocompx/tmap/my_map.svg\n#> Size: 8.34 by 5.87 inches\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\n\nZooming in and out of vector graphics does not affect their quality.\nAt the same time, the `width,` `height,` and `scale` arguments can still impact the output file.\nFor example, a vector graphic file saved with a narrower width value will have thicker lines and larger fonts compared to the one with a larger width value.\nYou can check this effect by saving the `tm` object with `width = 1` and then with `width = 10`.\n\nCompared to raster graphics, vector graphics are not suitable for storing complex images or maps, and they are less supported by web browsers comparing to rasters.\nThey, however, also have many advantages.\nFor example, they can be zoomed in and out without any decrease in quality.\nVector graphics can also be easily edited in dedicated software (e.g., Inkscape or Adobe Illustrator), which allows to change the style of map elements and move them using a computer mouse outside of the R environment.\nThis approach can be useful, for example, when you want to quickly adjust the position of map elements (e.g., labels) or collaborate with a graphic designer.\nNote, however, that this process is not fully reproducible.\n\n## Interactive format {#sec-interactive-format}\n\n`tmap` map objects can not only be viewed in the interactive mode (@sec-map-modes) but also saved as HTML files by adding the `.html` extension to the output file name.\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntmap_save(tm, \"my_map.html\")\n#> [view mode] Map component `tm_chart_none()` not supported in \"view\" mode.\n#> Interactive map saved to /home/jn/Science/geocompx/tmap/my_map.html\n#> \n#> This message is displayed once per session.\n```\n:::\n\n\n\nThe `tmap_save()` function also has several additional arguments reserved for the interactive format, including `selfcontained` and `in.iframe`.\nThe `selfcontained` argument with `TRUE` by default saves our map together with additional resources (e.g., JavaScript libraries) into one HTML file. \nOtherwise, additional resources will be saved in an adjacent directory.\nThe `in.iframe` argument (`FALSE` by default) allows saving an interactive map as an iframe -- when `TRUE` it creates two HTML files - a small HTML file with the iframe container and a large one with the actual map.\n<!-- when `in.iframe = TRUE` is useful?? -->\n<!-- arguments passed on to device functions or to saveWidget or saveWidgetframe -->\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}