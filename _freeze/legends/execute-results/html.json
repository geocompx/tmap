{
  "hash": "a5ebe10388892e60bd93805672f2d0bd",
  "result": {
    "engine": "knitr",
    "markdown": "\n::: {.cell}\n\n:::\n\n\n# Legends and titles {#sec-legends-and-titles}\n\nThis chapter covers legends and titles in **tmap** -- how to create, customize their appearance, and position them on the map.\nThe examples in this chapter use the elevation raster data of Slovenia in meters above sea level (*m asl*).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(terra)\nlibrary(tmap)\nslo_elev = rast(\"data/slovenia/slo_elev.tif\")\n```\n:::\n\n\n## Legends {#sec-legends}\n\n\\index{legends}\nLegends are an essential part of most maps.\nThey provide meaning to the symbols or colors used in the map, and often add information about the map's content.\nThey allow for interpreting the map correctly, and are therefore crucial for the map's readability.\n\nIn **tmap**, legends are created automatically when we add a layer with a data-driven visual variable.\nBy default, such a legend consists of a title based on the variable name and a color/shape/symbol scale (@fig-legend1). <!--REF to the color scale section?-->\nIt is placed outside of the map frame, either on the right or on the bottom of the map, depending on the automatically determined map aspect ratio.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster()\n```\n\n::: {.cell-output-display}\n![A map with an automatically generated legend.](figures/fig-legend1-1.png){#fig-legend1 fig-align='center' fig-pos='t' width=100%}\n:::\n:::\n\n\n\\index{tm_legend}\nSuch a legend is helpful for quick exploration of the data, but often, they are not sufficient for sharing the map with others.\nThis chapter covers how to customize the legend's title, position, and appearance in **tmap**.\nLegends are also closely related to the visual variables and scales used in the map that were covered in chapters @sec-visual-variables and @sec-scales -- we recommend reading those chapters first.\nLegends are customized using the `tm_legend()` function that is passed to `*.legend` arguments of the layer functions, e.g., `col.legend`, `shape.legend`, `size.legend`, etc.\n\nOften, the most significant part of the legend is the title.\nIt informs the reader about the meaning of the colors or symbols used in the map, providing also additional context such as the unit of measurement.\nThe title is set using the `title` argument of the `tm_legend()` function (@fig-legend2-1).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"Elevation (m asl)\"))\n```\n:::\n\n\nThe legend title and its text can be customized in many ways, including changing its font size (`title.size` and `text.size`), font family (`title.family` and `text.family`), and font color (`title.color` and `text.color`).\nIn some cases, the title is not needed, e.g., when the map is self-explanatory, and then this argument can be set to `\"\"`.\nAnother possibility, when only one legend is used, is to remove the legend title, but specify the map variable and its unit in the map title (@sec-titles).\n\nBy default, values in the legend are ordered from low to high (i.e., from top to bottom), but this can be reversed using the `reverse` argument (@fig-legend2-2).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(\n      col.legend = tm_legend(title = \"Elevation (m asl)\", \n                             reverse = TRUE)\n    )\n```\n:::\n\n\n\\index{positions}\nIn the Slovenia example, we have enough white space inside the map frame to fit the legend.\nYou can do this by setting the `position` argument in `tm_legend()` (@fig-legend2-3) and using `tm_pos_in()` to define the legendâ€™s location.\nThe first two arguments of `tm_pos_in()` specify where inside the map frame the legend will appear (@sec-positions).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(\n        col.legend = tm_legend(\n            title = \"Elevation (m asl)\",\n            position = tm_pos_in(\"right\", \"bottom\")\n        )\n    )\n```\n:::\n\n\n\n::: {#fig-legend2 .cell layout-nrow=\"3\" layout-align=\"center\"}\n::: {.cell-output-display}\n![legend with a custom title](figures/fig-legend2-1.png){#fig-legend2-1 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![legend with a custom title and reversed order](figures/fig-legend2-2.png){#fig-legend2-2 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![legend with a custom position inside the map frame](figures/fig-legend2-3.png){#fig-legend2-3 fig-align='center' fig-pos='t' width=100%}\n:::\n\nLegend customization examples.\n:::\n\n\nDepending on the map content, used colors, and expected aesthetic, the legend background can be colored or made transparent.\nThe default legend background is white, but we may change it using the `bg.color` argument of the `tm_legend()` function.\nIn the following example, we set the background color to gray and also make it semi-transparent using the `bg.alpha` argument (@fig-legend3-1).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(\n        col.legend = tm_legend(\n            title = \"Elevation (m asl)\",\n            position = tm_pos_in(\"right\", \"bottom\"),\n            bg.color = \"gray\",\n            bg.alpha = 0.5\n        )\n    )\n```\n:::\n\n\n\\index{legend orientation}\nAll of the previous examples used the default legend orientation type called `\"portrait\".`\nIts alternative is `\"landscape\"`, which can be set using the `orientation` argument of the `tm_legend()` function.\nThis changes the legend layout to horizontal, which can be useful either to fit the map content better or to change the map aesthetic.\n\nHere, we not only change the legend orientation, but also customize its position with `tm_pos_out()` (@sec-positions) ^[By default, the `\"landscape\"` legend is located in the bottom right outside of the map frame].\nThe three arguments used, `\"center\"`, `\"top\"`, and `\"center\"` specify the legend position in horizontal and vertical position outside the map frame, and then its position relative to that placement (@fig-legend3-2).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(\n        col.legend = tm_legend(\n            title = \"Elevation (m asl)\",\n            orientation = \"landscape\",\n            position = tm_pos_out(\"center\", \"top\", pos.h = \"center\")\n        )\n    )\n```\n:::\n\n\nTo disable the legend, we can set the `show` argument of the `tm_legend()` function to `FALSE` (@fig-legend3-3).\nThis is useful when we want to use the same legend for multiple layers, or just when we are only interested in the map content and not in the legend -- which may be the case when we are using the map for graphical purposes only.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(show = FALSE))\n```\n:::\n\n\n\n::: {#fig-legend3 .cell layout-nrow=\"3\" layout-align=\"center\"}\n::: {.cell-output-display}\n![legend with a custom background color and transparency](figures/fig-legend3-1.png){#fig-legend3-1 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![legend with a custom orientation and position outside the map frame](figures/fig-legend3-2.png){#fig-legend3-2 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![no legend](figures/fig-legend3-3.png){#fig-legend3-3 fig-align='center' fig-pos='t' width=100%}\n:::\n\nAdditional legend customization examples.\n:::\n\n\n<!-- tm_legend_bivariate -->\n<!-- tm_legend_combine -->\n<!-- tm_add_legend -->\n\n## Titles {#sec-titles}\n\n\\index{titles}\n\\index{tm\\_title}\nTitles are another essential part of the map, as they can provide context and information about the map content.\nIn **tmap**, titles are added with the `tm_title()` function. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"Elevation (m asl)\")) +\n  tm_title(\"Slovenia\")\n```\n:::\n\n\nTitles could serve a few roles. \nThey may provide a general description of the map content, such as the name of the area (@fig-titles1-1).\nTitles can also be used to replace the legend title (@fig-titles1-2) -- then the reader can interpret the map content based on the title, which is more prominent than the legend title.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"\")) +\n  tm_title(\"Elevation Map of Slovenia\")\n```\n:::\n\n\n\n::: {#fig-titles1 .cell layout-nrow=\"2\" layout-align=\"center\"}\n::: {.cell-output-display}\n![simple title](figures/fig-titles1-1.png){#fig-titles1-1 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![map title replacing the legend title](figures/fig-titles1-2.png){#fig-titles1-2 fig-align='center' fig-pos='t' width=100%}\n:::\n\nMap title examples.\n:::\n\n\nTitles are text elements and therefore can be customized in many ways, including changing the font size (`size`), font color (`color`), and font face (`fontface`) (@fig-titles2-1).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"\")) +\n  tm_title(\"Elevation Map of Slovenia\", \n           size = 1.5,\n           color = \"gray10\",\n           fontface = \"bold\"\n           )\n```\n:::\n\n\nWe can also add a background to the title, which can improve the visibility of the title text while providing a distinct aesthetic (@fig-titles2-2).\nA map title is treated as all of the rest of the map elements and, therefore, can be placed outside or inside of the map frame using the `position` argument of the `tm_title()` function (see @sec-positions for more details).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"\")) +\n  tm_title(\"Elevation Map of Slovenia\", \n           size = 1.5,\n           color = \"white\",\n           fontface = \"bold\",\n           bg = TRUE,\n           bg.color = \"black\",\n           position = tm_pos_out(\"center\", \"top\", pos.h = \"right\")\n           )\n```\n:::\n\n\n\n::: {#fig-titles2 .cell layout-nrow=\"2\" layout-align=\"center\"}\n::: {.cell-output-display}\n![with custom font size, color, and face](figures/fig-titles2-1.png){#fig-titles2-1 fig-align='center' fig-pos='t' width=100%}\n:::\n\n::: {.cell-output-display}\n![with custom font size, color, face, and background](figures/fig-titles2-2.png){#fig-titles2-2 fig-align='center' fig-pos='t' width=100%}\n:::\n\nTitle customization examples.\n:::\n\n\nMany titles can be used in the same map, e.g., a main title and a subtitle (@fig-titles3).\nThis can be done by adding multiple `tm_title()` functions to the map, which is placed on the top left of the map by default, and `tm_title_in()` function to place the title inside the top left corner of the map frame.\n\nA map can have multiple titles, such as a main title and a subtitle (@fig-titles3).\nYou can add them by including `tm_title()` functions, which by default place titles at the top left outside the map.\nTo position a title inside the top-left corner of the map frame instead, use the `tm_title_in()` function.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ntm_shape(slo_elev) +\n    tm_raster(col.legend = tm_legend(title = \"\")) +\n  tm_title(\"Slovenia\") +\n  tm_title_in(\"Elevation Map\")\n```\n\n::: {.cell-output-display}\n![A map with a title and a subtitle.](figures/fig-titles3-1.png){#fig-titles3 fig-align='center' fig-pos='t' width=100%}\n:::\n:::\n\n\n<!-- refs typography chapters/sections -->\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}